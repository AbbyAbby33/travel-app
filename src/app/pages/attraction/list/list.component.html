<h2>æ™¯é»åˆ—è¡¨</h2>

<div class="filter-group">
  <label for="category-select" class="filter-label">é¸æ“‡åˆ†é¡</label>
  <select id="category-select" class="filter-select" [(ngModel)]="selectedCategory"
    (change)="onCategoryChange(selectedCategory)">
    @for (category of categories; track $index) {
    <option [value]="category.id">
      {{ category.name }}
    </option>
    }
  </select>
</div>

<span class="result-count">å…± {{ totalCount }} å€‹æ™¯é»</span>

<!-- æˆ‘çš„æœ€æ„›æ“ä½œ -->
@if (attractions.length > 0) {
<div class="batch-actions">
  <div class="batch-left">
    <label class="checkbox-label">
      <input type="checkbox" [checked]="isAllSelected()" (change)="toggleSelectAll()">
      <span> å…¨é¸</span>
    </label>
    @if (selectedAttractions.size > 0) {
      <span class="selected-count">
        å·²é¸ {{ selectedAttractions.size }} é …
      </span>
    }
  </div>

  <button class="btn" [disabled]="selectedAttractions.size === 0" (click)="addSelectedToFavorites()">
    åŠ å…¥æˆ‘çš„æœ€æ„›
  </button>
</div>
}

@if (loading) {
<!-- è¼‰å…¥ä¸­ -->
<div class="loading">
  <div class="spinner"></div>
  <p>è¼‰å…¥ä¸­...</p>
</div>
} @else {
<!-- åˆ—è¡¨ -->
<div class="attractions-list">
  @for (attraction of attractions; track attraction.id) {

  <div class="attractions-card">

    <!-- åœ–ç‰‡ -->
    @if(attraction.images && attraction.images.length > 0) {
    <div class="card-image">
      <img [src]="attraction.images[0].src" [alt]="attraction.name">
    </div>
    }

    <!-- å…§å®¹ -->
    <div class="card-content">

      <div class="favorite-operate">
        @if(isFavorite(attraction.id)) {
        <span>â¤ï¸</span>
        } @else {
        <div class="card-checkbox">
          <input type="checkbox" [checked]="isSelected(attraction.id)" (change)="toggleSelection(attraction.id)">
        </div>
        }
      </div>

      <h3 class="card-title">{{ attraction.name }}</h3>

      <p class="card-description">
        {{ attraction.introduction?.slice(0, 100) }}{{ attraction.introduction!.length > 100 ? '...' : '' }}
      </p>

      <div class="card-info">
        <div class="info-item">
          <span class="info-icon" aria-hidden="true">ğŸ“</span>
          <span class="info-text">{{ attraction.address }}</span>
        </div>

        <div class="info-item">
          <span class="info-icon" aria-hidden="true">ğŸ“</span>
          <span class="info-text">{{ attraction.tel }}</span>
        </div>
      </div>

    </div>
  </div>

  } @empty {
  <!-- ç„¡è³‡æ–™ -->
  <div class="no-data">
    <p>æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„æ™¯é»</p>
  </div>
  }
</div>

<!-- åˆ†é  -->
@if (!loading && attractions.length > 0) {
<div class="pagination">
  <button class="page-btn" [disabled]="currentPage === 1" (click)="previousPage()">
    ä¸Šä¸€é 
  </button>

  <!-- ä¸­é–“é ç¢¼ -->
  <div class="page-numbers">
    @if (currentPage > 3) {
    <button class="page-number" (click)="goToPage(1)">
      1
    </button>
    }

    @if( currentPage > 3) {
    <span class="page-ellipsis">...</span>
    }

    @for (page of getPageRange(); track $index) {
    <button class="page-number" [class.active]="page === currentPage" (click)="goToPage(page)">
      {{ page }}
    </button>
    }

    @if (currentPage < totalPages - 2) { <span class="page-ellipsis">...</span>
      }

      @if (currentPage < totalPages - 2) { <button class="page-number" (click)="goToPage(totalPages)">
        {{ totalPages }}
        </button>
        }

  </div>

  <button class="page-btn" [disabled]="currentPage === totalPages" (click)="nextPage()">
    ä¸‹ä¸€é 
  </button>
</div>
}

}